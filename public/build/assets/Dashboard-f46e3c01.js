import{r,j as e,S as D,Q as a}from"./app-81b300e8.js";import{P as i}from"./PrimaryButton-b4b0a717.js";import{S}from"./Select-112c48f9.js";import{A as w}from"./AdminLayout-433a6839.js";import{I as o}from"./iconify-52d85b23.js";import"./ApplicationLogo-f2f2a351.js";import"./Dropdown-bc20cfcd.js";import"./transition-18508532.js";import"./Modal-85d668ab.js";function B({auth:f}){const[t,j]=r.useState([]),[n,d]=r.useState(!1),[p,m]=r.useState(!1),[x,u]=r.useState(!1),[c,g]=r.useState(""),b=async()=>{try{u(!0),await axios.post(route("api.parse.timetable"),{dep:t[c]}),a.success("Розклад спизджено")}catch(s){a.error(s.response.data.error)}finally{u(!1)}},N=async()=>{try{d(!0),(await axios.post(route("api.parse.dep"))).data.filter(l=>!t.includes(l)).forEach(async l=>{const v={name:l,short:l,chief:"-"};response=await axios.post(route("department.store"),v)}),a.success("Факультети спизджено")}catch(s){a.error(s),a.error(s.response.data.error)}finally{h(),d(!1)}},y=async()=>{try{m(!0),await axios.post(route("api.parse.group"),{dep:t[c]}),a.success("Задача виконана успішно")}catch(s){a.error(s)}finally{m(!1)}},h=async()=>{try{const s=await axios.get(route("api.fetch.dep"));j(s.data)}catch(s){a.error(s.response.data.error)}};return r.useEffect(()=>{h()},[]),e.jsxs(w,{user:f.user,header:e.jsx("h2",{className:"font-medium text-lg lg:text-2xl",children:"Dashboard"}),children:[e.jsx(D,{title:"Dashboard"}),e.jsx("div",{className:"pb-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{children:[e.jsx("div",{className:"p-6",children:"Парсер розкладу нау"}),e.jsxs("div",{className:"admin-list",children:[e.jsxs("div",{className:"card-default bg-orange-100 inline-flex",children:[e.jsx(o,{icon:"akar-icons:info",className:"w-6 h-6"}),e.jsxs("span",{children:["Якщо виникають проблеми зі створенням розкладу, писати ",e.jsx("a",{href:"https://t.me/lo1ri_andy",target:"_blank",className:"font-semibold underline text-blue-600",children:"мені"})]})]}),e.jsxs("div",{className:"card-default",children:[e.jsxs("h2",{className:"text-lg mb-1",children:["Кількість факультетів: ",t.length]}),e.jsx(i,{disabled:n,onClick:()=>N(),children:n?e.jsx(o,{icon:"svg-spinners:bars-scale",className:"w-6 h-6 mx-auto"}):e.jsx(e.Fragment,{children:"Оновити факультети"})})]}),e.jsxs("div",{className:"card-default",children:[e.jsxs("h2",{className:"text-lg mb-1",children:["Назви груп,"," ",e.jsx("a",{href:"https://portal.nau.edu.ua/schedule/group/list",className:"text-blue-600 underline",target:"_blank",children:"переглянути тут"})]}),e.jsxs("div",{className:"flex flex-col gap-3 lg:grid lg:grid-cols-3",children:[e.jsx(S,{options:t,defaultValue:"Виберіть факультет",defaultSelectable:!1,value:c,onChange:s=>g(s)}),e.jsx(i,{className:"col-span-1",disabled:p,onClick:()=>y(),children:p?e.jsx(o,{icon:"svg-spinners:bars-scale",className:"w-6 h-6 mx-auto"}):e.jsx(e.Fragment,{children:"Зберегти групи"})}),e.jsx(i,{className:"col-span-1",disabled:x,onClick:()=>b(),children:x?e.jsx(o,{icon:"svg-spinners:bars-scale",className:"w-6 h-6 mx-auto"}):e.jsx(e.Fragment,{children:"Зберегти розклад"})})]})]})]})]})})})]})}export{B as default};
