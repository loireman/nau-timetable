import{r as c,j as e,g as T,a as D}from"./app-1d7458f5.js";import{A as I}from"./AuthenticatedLayout-aa66f09d.js";import"./Select-f8bb2b21.js";import{I as E}from"./InputSwitch-405d994a.js";import"./iconify-8b3d2781.js";import"./ApplicationLogo-18eab4af.js";import"./Dropdown-d611887e.js";import"./transition-f1bb71c3.js";const M=({currentLesson:f=1,currentDay:l=1,currentWeek:u=1,selectedPGroup:v,timetable:o,weekDefault:w})=>{const[r,N]=c.useState(0);c.useEffect(()=>{N(w)},[w]);const p=i=>{N(i)},j=i=>{const d=new Date().getTimezoneOffset(),m=300+(i-1)*110-d,s=m+95,n=x=>{var S=Math.floor(x/60),x=x%60;return S+":"+(x<10?"0"+x:x)};return`${n(m)} - ${n(s)}`};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex content-center items-center gap-4 justify-center mb-4",children:[e.jsx("span",{className:"font-semibold text-xl",children:"Week 1"}),e.jsx(E,{initialValue:r,onChange:p}),e.jsx("span",{className:"font-semibold text-xl",children:"Week 2"})]}),e.jsxs("table",{className:"timetable",children:[e.jsx("thead",{children:e.jsx("tr",{children:["Пн","Вт","Ср","Чт","Пт","Сб"].map((i,d)=>e.jsx("th",{className:`${d+1===l&&r+1===u?"day-active":""}`,children:i},d))})}),e.jsx("tbody",{children:[1,2,3,4,5,6,7].map(i=>e.jsx("tr",{children:[1,2,3,4,5,6].map((d,m)=>e.jsxs("td",{className:`${m+1===l&&r+1===u?"day-active":""}`,children:[d===1?e.jsx("div",{className:"time",children:j(i)}):e.jsx("div",{className:"time inactive"}),o.map((s,n)=>e.jsx("div",{children:(s.pgroup===0||s.pgroup==v)&&s.week===r+1&&s.day===d&&s.lesson===i?e.jsxs("div",{className:"card-default relative overflow-hidden lesson",children:[e.jsx("div",{className:`lesson-type type-${s.type} ${s.week===u&&s.day===l&&s.lesson===f?"active":""}`}),e.jsx("span",{className:"text-xl font-semibold",children:s.name})]}):null},n))]},d))},i))})]})]})},P=M,G=({selectedDay:f,onSelectDay:l})=>{const u=["Пн","Вт","Ср","Чт","Пт","Сб"];return e.jsx("div",{className:"day-selector",children:u.map((v,o)=>e.jsx("span",{className:`font-semibold ${f===o+1?"day-active":""}`,onClick:()=>l(o+1),children:v},o))})},F=({selectedWeek:f,onSelectWeek:l})=>e.jsxs("div",{className:"week-selector",children:[e.jsx("span",{className:`font-semibold ${f===0?"week-active":""}`,onClick:()=>l(0),children:"Тиждень 1"}),e.jsx("span",{className:`font-semibold ${f===1?"week-active":""}`,onClick:()=>l(1),children:"Тиждень 2"})]}),R=({currentLesson:f=1,currentDay:l=1,currentWeek:u=1,selectedPGroup:v,timetable:o,weekDefault:w})=>{const[r,N]=c.useState(w),[p,j]=c.useState(l);c.useEffect(()=>{N(w),j(l)},[w,l]);const i=s=>{N(s)},d=s=>{const n=new Date().getTimezoneOffset(),g=300+(s-1)*110-n,S=g+95,x=t=>{var k=Math.floor(t/60),t=t%60;return k+":"+(t<10?"0"+t:t)};return`${x(g)} - ${x(S)}`},m=s=>{j(s)};return e.jsxs("div",{className:"timetable-container",children:[e.jsxs("table",{className:"timetable",children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{className:`text-xl ${l===p&&r+1===u?"day-active":""}`,children:["Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота"][p-1]})})}),e.jsx("tbody",{children:[1,2,3,4,5,6,7].map(s=>e.jsx("tr",{children:e.jsxs("td",{className:`${p===l&&r+1===u?"day-active":""}`,children:[e.jsx("div",{className:"time",children:e.jsx("span",{children:d(s)})}),o.map((n,g)=>e.jsx("div",{children:(n.pgroup===0||n.pgroup==v)&&n.week===r+1&&n.day===p&&n.lesson===s?e.jsxs("div",{className:"card-default relative overflow-hidden lesson",children:[e.jsx("div",{className:`lesson-type type-${n.type} ${n.week===u&&n.day===l&&n.lesson===f?"active":""}`}),e.jsx("span",{className:"text-xl font-semibold",children:n.name})]}):null},g))]})},s))})]}),e.jsxs("div",{className:"selectors-bottom",children:[e.jsx(F,{selectedWeek:r,onSelectWeek:i}),e.jsx("div",{className:"vertical-line"}),e.jsx(G,{selectedDay:p,onSelectDay:m})]})]})},W=R,O=c.forwardRef(function({type:l="search",className:u="",isFocused:v=!1,suggestionsEndpoint:o,onSearch:w,defaultValue:r="",...N},p){const j=p||c.useRef(),[i,d]=c.useState(r),[m,s]=c.useState([]),[n,g]=c.useState(!1);c.useEffect(()=>{T.get(`${o}`).then(a=>{s(a.data)}).catch(a=>{console.error("Error fetching suggestions:",a)})},[]),c.useEffect(()=>{v&&(j.current.focus(),g(!0))},[v]);const S=()=>{setTimeout(()=>{g(!1)},90)},x=()=>{g(!0)},C=()=>{j.current.focus(),g(!0)},k=a=>{const h=a.target.value;d(h),o&&T.get(`${o}/${h}`).then(b=>{s(b.data)}).catch(b=>{console.error("Error fetching suggestions:",b)})},t=a=>{a&&(d(a),w(a),j.current.blur())};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:`form-search ${u}`,onClick:C,children:[e.jsx("input",{...N,type:l,ref:j,value:i,onChange:k,onBlur:S,onFocus:x}),n&&m.length!==0&&e.jsx("ul",{className:"options",style:{maxHeight:m.length>10?"200px":"auto",overflowY:"auto"},children:Object.keys(m).map(a=>e.jsx("li",{className:"option",onClick:()=>t(m[a]),children:m[a]},a))})]})})});function Q({auth:f,group:l}){const[u,v]=c.useState([]),[o,w]=c.useState(l),[r,N]=c.useState(0),[p,j]=c.useState(0),[i,d]=c.useState(0),[m,s]=c.useState(0),[n,g]=c.useState(0);async function S(t){if(t!=""){const a=await T.get(`/api/v1/group/${t}`);a.data.data.timetables&&v(a.data.data.timetables)}}const x=()=>{var t=new Date(new Date().toLocaleString("en",{timeZone:"Europe/Rome"})),a=t.getDay(),h=t.getHours()*60+t.getMinutes(),b=0;if(h>525&&h<1275)for(h=h-525,b++;h>0;)h=h-110,b++;t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var y=new Date(t.getFullYear(),0,4),$=1+Math.round(((t.getTime()-y.getTime())/864e5-3+(y.getDay()+6)%7)/7);$=($%2==(a==0)?1:0)+1,j($-1),d($),s(a),g(b)};c.useEffect(()=>{S(o),x()},[o]);const C=t=>{const a=new URL(window.location),h="group";w(t),a.searchParams.has(h)?a.searchParams.set(h,t):a.searchParams.append(h,t),window.history.pushState({},"",a);const b=new Event("urlchange");window.dispatchEvent(b)},k=t=>{N(t)};return e.jsxs(I,{user:f.user,children:[e.jsx(D,{title:"Timetable"}),e.jsxs("div",{className:"bg-white",children:[e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-2 lg:gap-6 p-6 text-gray-900 w-full",children:[e.jsx("div",{className:"min-w-[190px] max-w-[260px] grid lg:gap-3",children:e.jsx(O,{suggestionsEndpoint:"/api/v1/search/group",onSearch:C,defaultValue:o,isFocused:!1})}),e.jsx("div",{className:"min-w-[190px] max-w-[260px] content-center grid lg:gap-3",children:e.jsxs("div",{className:"flex content-center items-center gap-4 justify-center",children:[e.jsx("span",{className:"font-semibold text-xl",children:"1"}),e.jsx(E,{initialValue:r,onChange:k}),e.jsx("span",{className:"font-semibold text-xl",children:"2"})]})})]}),e.jsx("div",{className:"grid px-6 text-gray-900 w-full gap-12 max-xl:hidden",children:e.jsx(P,{currentLesson:n,currentDay:m,currentWeek:i,selectedPGroup:r+1,timetable:u,weekDefault:p})}),e.jsx("div",{className:"grid px-6 text-gray-900 w-full gap-12 xl:hidden",children:e.jsx(W,{currentLesson:n,currentDay:m,currentWeek:i,selectedPGroup:r+1,timetable:u,weekDefault:p})})]})]})}export{Q as default};
