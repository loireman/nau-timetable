import{r as a,j as t,a as L,f as M}from"./app-016bccd2.js";import{A as F}from"./AuthenticatedLayout-bcc2eb84.js";import{S as H,T as R,a as _}from"./SearchExtInput-e56c17ff.js";import{I as A}from"./InputSwitch-0db9d4a7.js";import"./ApplicationLogo-a2b4986f.js";import"./Dropdown-a71b8373.js";import"./transition-5f76e59c.js";import"./iconify-1c36c437.js";function O({auth:f,group:w,startWeek:j}){const[u,v]=a.useState([]),[o,S]=a.useState(w),[c,y]=a.useState(0),[p,D]=a.useState(0),[d,k]=a.useState(0),[m,b]=a.useState(0),[x,N]=a.useState(0),[E,G]=a.useState(!1),[r,T]=a.useState(!1),[Y,P]=a.useState("");async function C(e){if(e!=""){const s=await M.get(`/api/v1/group/${e}`);s.data.timetables&&(v(s.data.timetables),G(s.data.single_group),T(s.data.single_week))}}const g=()=>{var e=new Date(new Date().toLocaleString("en",{timeZone:"Europe/Rome"})),s=e.getDay(),n=e.getHours()*60+e.getMinutes(),i=0;if(n>525&&n<1275)for(n=n-525,i++;n>0;)n=n-110,i++;P(e.getHours()+":"+e.getMinutes()),e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var h=j?new Date(e.getFullYear(),0,11):new Date(e.getFullYear(),0,4),l=1+Math.round(((e.getTime()-h.getTime())/864e5-3+(h.getDay()+6)%7)/7);l=(l%2==(s==0)?1:0)+1,D(l-1),k(l),b(s==0?s+1:s),N(i)};a.useEffect(()=>{C(o),g()},[o]),a.useEffect(()=>{const e=setInterval(async()=>await g(),2e4);return function(){clearInterval(e)}},[]);const W=e=>{const s=new URL(window.location),n="group";S(e),s.searchParams.has(n)?s.searchParams.set(n,e):s.searchParams.append(n,e),window.history.pushState({},"",s);const i=new Event("urlchange");window.dispatchEvent(i)},I=e=>{y(e)};return t.jsxs(F,{user:f.user,children:[t.jsx(L,{title:"Timetable"}),t.jsxs("div",{className:"bg-white",children:[t.jsx("div",{className:"flex justify-between px-6 py-2",children:t.jsx("h1",{className:"text-2xl font-semibold",children:"Розклад групи"})}),t.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-2 lg:gap-6 px-6 py-4 text-gray-900 w-full",children:[t.jsx("div",{className:"min-w-[190px] max-w-[260px] grid lg:gap-3",children:t.jsx(H,{suggestionsEndpoint:"/api/v1/search/group",onSearch:W,defaultValue:o,isFocused:!1})}),!E&&t.jsx("div",{className:"min-w-[190px] max-w-[260px] content-center grid lg:gap-3",children:t.jsxs("div",{className:"flex content-center items-center gap-4 justify-center",children:[t.jsx("span",{className:"font-semibold text-xl",children:"1"}),t.jsx(A,{initialValue:c,onChange:I}),t.jsx("span",{className:"font-semibold text-xl",children:"2"})]})})]}),t.jsx("div",{className:"grid px-6 text-gray-900 w-full gap-12 max-xl:hidden",children:t.jsx(R,{currentLesson:x,currentDay:m,currentWeek:r||d,selectedPGroup:c+1,timetable:u,weekDefault:r?!r:p,singleWeek:r})}),t.jsx("div",{className:"grid px-6 text-gray-900 w-full gap-12 xl:hidden",children:t.jsx(_,{currentLesson:x,currentDay:m,currentWeek:r||d,selectedPGroup:c+1,timetable:u,weekDefault:r?!r:p,singleWeek:r})})]})]})}export{O as default};
