import{r as l,j as e,a as B,g as y}from"./app-52fa4ca3.js";import{A as J}from"./AuthenticatedLayout-bf5ca713.js";import{S as D}from"./Select-0a2ac8cd.js";import{I as K}from"./InputSwitch-a3ca12e0.js";import"./ApplicationLogo-76fc1072.js";import"./Dropdown-b293cd61.js";import"./transition-5db78f27.js";const Q=({currentLesson:u=1,currentDay:n=1,currentWeek:c=1,selectedPGroup:p,timetable:h,weekDefault:f})=>{const[m,v]=l.useState(0);l.useEffect(()=>{v(f)},[f]);const j=i=>{v(i)},N=i=>{const o=new Date().getTimezoneOffset(),g=300+(i-1)*110-o,s=g+155,a=d=>{var w=Math.floor(d/60),d=d%60;return w+":"+(d<10?d+"0":d)};return`${a(g)} - ${a(s)}`};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex content-center items-center gap-4 justify-center mb-4",children:[e.jsx("span",{className:"font-semibold text-xl",children:"Week 1"}),e.jsx(K,{initialValue:m,onChange:j}),e.jsx("span",{className:"font-semibold text-xl",children:"Week 2"})]}),e.jsxs("table",{className:"timetable",children:[e.jsx("thead",{children:e.jsx("tr",{children:["Пн","Вт","Ср","Чт","Пт","Сб"].map((i,o)=>e.jsx("th",{className:`${o+1===n&&m+1===c?"day-active":""}`,children:i},o))})}),e.jsx("tbody",{children:[1,2,3,4,5,6,7].map(i=>e.jsx("tr",{children:[1,2,3,4,5,6].map((o,g)=>e.jsxs("td",{className:`${g+1===n&&m+1===c?"day-active":""}`,children:[o===1?e.jsx("div",{className:"time",children:N(i)}):e.jsx("div",{className:"time inactive"}),h.map((s,a)=>e.jsx("div",{children:(s.pgroup===0||s.pgroup==p)&&s.week===m+1&&s.day===o&&s.lesson===i?e.jsxs("div",{className:"card-default relative overflow-hidden lesson",children:[e.jsx("div",{className:`lesson-type type-${s.type} ${s.week===c&&s.day===n&&s.lesson===u?"active":""}`}),e.jsx("span",{className:"text-xl font-semibold",children:s.name})]}):null},a))]},o))},i))})]})]})},U=Q,X=({selectedDay:u,onSelectDay:n})=>{const c=["Пн","Вт","Ср","Чт","Пт","Сб"];return e.jsx("div",{className:"day-selector",children:c.map((p,h)=>e.jsx("span",{className:`font-semibold ${u===h+1?"day-active":""}`,onClick:()=>n(h+1),children:p},h))})},_=({selectedWeek:u,onSelectWeek:n})=>e.jsxs("div",{className:"week-selector",children:[e.jsx("span",{className:`font-semibold ${u===0?"week-active":""}`,onClick:()=>n(0),children:"Тиждень 1"}),e.jsx("span",{className:`font-semibold ${u===1?"week-active":""}`,onClick:()=>n(1),children:"Тиждень 2"})]}),ee=({currentLesson:u=1,currentDay:n=1,currentWeek:c=1,selectedPGroup:p,timetable:h,weekDefault:f})=>{const[m,v]=l.useState(f),[j,N]=l.useState(n);l.useEffect(()=>{v(f),N(n)},[f,n]);const i=s=>{v(s)},o=s=>{const a=new Date().getTimezoneOffset(),b=300+(s-1)*110-a,w=b+155,d=x=>{var k=Math.floor(x/60),x=x%60;return k+":"+(x<10?x+"0":x)};return`${d(b)} - ${d(w)}`},g=s=>{N(s)};return e.jsxs("div",{className:"timetable-container",children:[e.jsxs("table",{className:"timetable",children:[e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("th",{className:`text-xl ${n===j&&m+1===c?"day-active":""}`,children:["Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота"][j-1]})})}),e.jsx("tbody",{children:[1,2,3,4,5,6,7].map(s=>e.jsx("tr",{children:e.jsxs("td",{className:`${j===n&&m+1===c?"day-active":""}`,children:[e.jsx("div",{className:"time",children:e.jsx("span",{children:o(s)})}),h.map((a,b)=>e.jsx("div",{children:(a.pgroup===0||a.pgroup==p)&&a.week===m+1&&a.day===j&&a.lesson===s?e.jsxs("div",{className:"card-default relative overflow-hidden lesson",children:[e.jsx("div",{className:`lesson-type type-${a.type} ${a.week===c&&a.day===n&&a.lesson===u?"active":""}`}),e.jsx("span",{className:"text-xl font-semibold",children:a.name})]}):null},b))]})},s))})]}),e.jsxs("div",{className:"selectors-bottom",children:[e.jsx(_,{selectedWeek:m,onSelectWeek:i}),e.jsx("div",{className:"vertical-line"}),e.jsx(X,{selectedDay:j,onSelectDay:g})]})]})},se=ee;function de({auth:u,department:n,stream:c,group:p,pgroup:h}){const[f,m]=l.useState([]),[v,j]=l.useState([]),[N,i]=l.useState(n),[o,g]=l.useState([]),[s,a]=l.useState(c),[b,w]=l.useState([]),[d,T]=l.useState(p),[k,x]=l.useState(h),[G,P]=l.useState(0),[E,z]=l.useState(0),[W,A]=l.useState(0),[V,H]=l.useState(0);async function R(){const t=await y.get("/api/v1/departments");j(t.data.data)}async function O(t){const S=await y.get(`/api/v1/streams/${t}`);g(S.data.data)}async function $(t,S=null){const r=await y.get(`/api/v1/groups/${t}`+(S!=null?`/${S}`:""));r.data.data.groups&&w(r.data.data.groups),r.data.data.timetables&&m(r.data.data.timetables)}const F=()=>{var t=new Date(new Date().toLocaleString("en",{timeZone:"Europe/Rome"})),S=t.getDay(),r=t.getHours()*60+t.getMinutes(),M=0;if(r>525&&r<1275)for(r=r-525,M++;r>0;)r=r-110,M++;t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var L=new Date(t.getFullYear(),0,4),C=1+Math.round(((t.getTime()-L.getTime())/864e5-3+(L.getDay()+6)%7)/7);C=(C%2==(S==0)?1:0)+1,P(C-1),z(C),A(S),H(M)};l.useEffect(()=>{R(),O(c),$(c),$(c,p),F()},[c,p]);const I=t=>{i(t),O(t),a(0),T(0),x(0)},Y=t=>{a(t),$(t),T(0),x(0)},Z=t=>{T(t),$(s,t),x(0)},q=t=>{x(t)};return e.jsxs(J,{user:u.user,children:[e.jsx(B,{title:"Timetable"}),e.jsxs("div",{className:"bg-white",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 lg:gap-6 p-6 text-gray-900 w-full",children:[e.jsxs("div",{className:"min-w-[190px] grid lg:gap-3",children:[e.jsx("span",{className:"font-bold lg:text-xl",children:"Факультет"}),e.jsx(D,{options:v,defaultValue:"Виберіть факультет",defaultSelectable:!1,value:N,onChange:I})]}),e.jsxs("div",{className:"min-w-[190px] grid lg:gap-3",children:[e.jsx("span",{className:"font-bold lg:text-xl",children:"Поток"}),N!=0?e.jsx(D,{options:o,defaultValue:"Виберіть поток",defaultSelectable:!1,value:s,onChange:Y}):null]}),e.jsxs("div",{className:"min-w-[190px] grid lg:gap-3",children:[e.jsx("span",{className:"font-bold lg:text-xl",children:"Група"}),s!=0?e.jsx(D,{options:b,defaultValue:"Виберіть групу",defaultSelectable:!1,value:d,onChange:Z}):null]}),e.jsxs("div",{className:"min-w-[190px] grid lg:gap-3",children:[e.jsx("span",{className:"font-bold lg:text-xl",children:"Підгрупа"}),d!=0?e.jsx(D,{options:["Без підгруп","Перша","Друга"],defaultValue:"Без підгруп",defaultSelectable:!1,value:k,onChange:q}):null]})]}),e.jsx("div",{className:"grid px-6 text-gray-900 w-full gap-12 max-xl:hidden",children:e.jsx(U,{currentLesson:V,currentDay:W,currentWeek:E,selectedPGroup:k,timetable:f,weekDefault:G})}),e.jsx("div",{className:"grid px-6 text-gray-900 w-full gap-12 xl:hidden",children:e.jsx(se,{currentLesson:V,currentDay:W,currentWeek:E,selectedPGroup:k,timetable:f,weekDefault:G})})]})]})}export{de as default};
