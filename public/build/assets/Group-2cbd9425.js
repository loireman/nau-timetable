import{r as a,j as t,a as M,f as H}from"./app-39103341.js";import{A as R}from"./AuthenticatedLayout-d728296f.js";import{S as _,T as A,a as F}from"./SearchExtInput-a7c36908.js";import{I as U}from"./InputSwitch-bfeb74b2.js";import"./ApplicationLogo-6719680e.js";import"./Dropdown-477af93e.js";import"./transition-6017fa6d.js";import"./iconify-f720f908.js";function O({auth:f,group:w,startWeek:j}){const[u,v]=a.useState([]),[c,S]=a.useState(w),[o,y]=a.useState(0),[p,k]=a.useState(0),[d,D]=a.useState(0),[m,b]=a.useState(0),[x,N]=a.useState(0),[E,G]=a.useState(!1),[r,T]=a.useState(!1),[P,C]=a.useState("");async function W(e){if(e!=""){const s=await H.get(`/api/v1/group/${e}`);s.data.timetables&&(v(s.data.timetables),G(s.data.single_group),T(s.data.single_week))}}const g=()=>{var e=new Date(new Date().toLocaleString("en",{timeZone:"Europe/Rome"})),s=e.getDay(),n=e.getHours()*60+e.getMinutes(),i=0;if(n>525&&n<1275)for(n=n-525,i++;n>0;)n=n-110,i++;C(e.getHours()+":"+e.getMinutes()),e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var h=new Date(e.getFullYear(),0,4),l=1+Math.round(((e.getTime()-h.getTime())/864e5-3+(h.getDay()+6)%7)/7);l=((l+j)%2==(s==0)?1:0)+1,k(l-1),D(l),b(s==0?s+1:s),N(i)};a.useEffect(()=>{W(c),g()},[c]),a.useEffect(()=>{const e=setInterval(async()=>await g(),2e4);return function(){clearInterval(e)}},[]);const I=e=>{const s=new URL(window.location),n="group";S(e),s.searchParams.has(n)?s.searchParams.set(n,e):s.searchParams.append(n,e),window.history.pushState({},"",s);const i=new Event("urlchange");window.dispatchEvent(i)},L=e=>{y(e)};return t.jsxs(R,{user:f.user,children:[t.jsx(M,{title:"Timetable"}),t.jsxs("div",{className:"bg-white",children:[t.jsxs("div",{className:"flex justify-between px-6 py-2",children:[t.jsx("h1",{className:"text-2xl font-semibold",children:"Розклад групи"}),t.jsxs("h2",{children:["Час: ",P]})]}),t.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-2 lg:gap-6 px-6 py-4 text-gray-900 w-full",children:[t.jsx("div",{className:"min-w-[190px] max-w-[260px] grid lg:gap-3",children:t.jsx(_,{suggestionsEndpoint:"/api/v1/search/group",onSearch:I,defaultValue:c,isFocused:!1})}),!E&&t.jsx("div",{className:"min-w-[190px] max-w-[260px] content-center grid lg:gap-3",children:t.jsxs("div",{className:"flex content-center items-center gap-4 justify-center",children:[t.jsx("span",{className:"font-semibold text-xl",children:"1"}),t.jsx(U,{initialValue:o,onChange:L}),t.jsx("span",{className:"font-semibold text-xl",children:"2"})]})})]}),t.jsx("div",{className:"grid px-6 text-gray-900 w-full gap-12 max-xl:hidden",children:t.jsx(A,{currentLesson:x,currentDay:m,currentWeek:r||d,selectedPGroup:o+1,timetable:u,weekDefault:r?!r:p,singleWeek:r})}),t.jsx("div",{className:"grid px-6 text-gray-900 w-full gap-12 xl:hidden",children:t.jsx(F,{currentLesson:x,currentDay:m,currentWeek:r||d,selectedPGroup:o+1,timetable:u,weekDefault:r?!r:p,singleWeek:r})})]})]})}export{O as default};
