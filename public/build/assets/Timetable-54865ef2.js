import{r as l,j as t,a as K,g as j}from"./app-3e2d690e.js";import{A as Q}from"./AuthenticatedLayout-93588f85.js";import{S as m}from"./Select-85cb1885.js";import{I as U}from"./InputSwitch-c6ff2b85.js";import"./ApplicationLogo-51fabdac.js";import"./Dropdown-bde795fb.js";import"./transition-e0a7a588.js";function le({auth:C,department:k,stream:c,group:p,pgroup:y}){const[G,T]=l.useState([]),[$,W]=l.useState([]),[v,V]=l.useState(k),[E,M]=l.useState([]),[x,S]=l.useState(c),[L,P]=l.useState([]),[w,h]=l.useState(p),[b,i]=l.useState(y),[o,N]=l.useState(0),[f,A]=l.useState(0),[g,H]=l.useState(0),[O,R]=l.useState(0);async function z(){const e=await j.get("/api/v1/departments");W(e.data.data)}async function D(e){const n=await j.get(`/api/v1/streams/${e}`);M(n.data.data)}async function d(e,n=null){const a=await j.get(`/api/v1/groups/${e}`+(n!=null?`/${n}`:""));a.data.data.groups&&P(a.data.data.groups),a.data.data.timetables&&T(a.data.data.timetables)}const F=()=>{var e=new Date(new Date().toLocaleString("en",{timeZone:"Europe/Rome"})),n=e.getDay(),a=e.getHours()*60+e.getMinutes(),s=0;if(a>525&&a<1275)for(a=a-525,s++;a>0;)a=a-110,s++;e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var r=new Date(e.getFullYear(),0,4),u=1+Math.round(((e.getTime()-r.getTime())/864e5-3+(r.getDay()+6)%7)/7);u=(u%2==(n==0)?1:0)+1,N(u-1),A(u),H(n),R(s)};l.useEffect(()=>{z(),D(c),d(c),d(c,p),F()},[c,p]);const I=e=>{V(e),D(e),S(0),h(0),i(0)},Y=e=>{S(e),d(e),h(0),i(0)},Z=e=>{h(e),d(x,e),i(0)},q=e=>{i(e)},B=e=>{N(e)},J=e=>{var n=new Date().getTimezoneOffset(),a=300+(e-1)*110-n,s=Math.floor(a/60),r=a%60;return s+":"+(r==0?"00":r)};return t.jsxs(Q,{user:C.user,children:[t.jsx(K,{title:"Timetable"}),t.jsxs("div",{className:"bg-white",children:[t.jsxs("div",{className:"flex flex-wrap gap-6 p-6 text-gray-900 w-full",children:[t.jsxs("div",{className:"min-w-[190px] grid gap-3",children:[t.jsx("span",{className:"font-bold text-xl",children:"Факультет"}),t.jsx(m,{options:$,defaultValue:"Виберіть факультет",defaultSelectable:!1,value:v,onChange:I})]}),t.jsxs("div",{className:"min-w-[190px] grid gap-3",children:[t.jsx("span",{className:"font-bold text-xl",children:"Поток"}),v!=0?t.jsx(m,{options:E,defaultValue:"Виберіть поток",defaultSelectable:!1,value:x,onChange:Y}):null]}),t.jsxs("div",{className:"min-w-[190px] grid gap-3",children:[t.jsx("span",{className:"font-bold text-xl",children:"Група"}),x!=0?t.jsx(m,{options:L,defaultValue:"Виберіть групу",defaultSelectable:!1,value:w,onChange:Z}):null]}),t.jsxs("div",{className:"min-w-[190px] grid gap-3",children:[t.jsx("span",{className:"font-bold text-xl",children:"Підгрупа"}),w!=0?t.jsx(m,{options:["Без підгруп","Перша","Друга"],defaultValue:"Без підгруп",defaultSelectable:!1,value:b,onChange:q}):null]})]}),t.jsxs("div",{className:"grid px-6 text-gray-900 w-full gap-12 max-xl:hidden",children:[t.jsxs("div",{className:"flex content-center items-center gap-4 justify-center",children:[t.jsx("span",{className:"font-semibold text-xl",children:"Week 1"}),t.jsx(U,{initialValue:o,onChange:B}),t.jsx("span",{className:"font-semibold text-xl",children:"Week 2"})]}),t.jsxs("table",{className:"timetable",children:[t.jsx("thead",{children:t.jsx("tr",{children:["Пн","Вт","Ср","Чт","Пт","Сб"].map((e,n)=>t.jsx("th",{className:`${n+1==g&&o+1==f?"day-active":""}`,children:e},n))})}),t.jsx("tbody",{children:[1,2,3,4,5,6,7].map(e=>t.jsx("tr",{children:[1,2,3,4,5,6].map((n,a)=>t.jsxs("td",{className:`${a+1==g&&o+1==f?"day-active":""}`,children:[t.jsx("div",{className:"time",children:J(e)}),G.map((s,r)=>t.jsx("div",{children:(s.pgroup==0||s.pgroup==b)&&s.week==o+1&&s.day==n&&s.lesson==e?t.jsxs("div",{className:"card-default relative overflow-hidden lesson",children:[t.jsx("div",{className:`lesson-type type-${s.type} ${s.week==f&&s.day==g&&s.lesson==O?"active":""}`}),t.jsx("span",{className:"text-xl font-semibold",children:s.name})]}):null},r))]},n))},e))})]})]})]})]})}export{le as default};
