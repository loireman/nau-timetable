import{r as a,j as t,a as L,f as M}from"./app-abb73a69.js";import{A as H}from"./AuthenticatedLayout-b120fc84.js";import{S as R,T as _,a as A}from"./SearchExtInput-9a93583a.js";import{I as F}from"./InputSwitch-281a1ab2.js";import"./ApplicationLogo-72cfc248.js";import"./Dropdown-fb7dd25e.js";import"./transition-1df54af1.js";import"./iconify-5280aef2.js";function K({auth:f,group:w}){const[u,j]=a.useState([]),[c,v]=a.useState(w),[o,S]=a.useState(0),[p,y]=a.useState(0),[d,k]=a.useState(0),[m,D]=a.useState(0),[x,b]=a.useState(0),[N,E]=a.useState(!1),[r,G]=a.useState(!1),[T,P]=a.useState("");async function C(e){if(e!=""){const s=await M.get(`/api/v1/group/${e}`);s.data.timetables&&(j(s.data.timetables),E(s.data.single_group),G(s.data.single_week))}}const g=()=>{var e=new Date(new Date().toLocaleString("en",{timeZone:"Europe/Rome"})),s=e.getDay(),n=e.getHours()*60+e.getMinutes(),i=0;if(n>525&&n<1275)for(n=n-525,i++;n>0;)n=n-110,i++;P(e.getHours()+":"+e.getMinutes()),e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var h=new Date(e.getFullYear(),0,4),l=1+Math.round(((e.getTime()-h.getTime())/864e5-3+(h.getDay()+6)%7)/7);l=(l%2==(s==0)?1:0)+1,y(l-1),k(l),D(s==0?s+1:s),b(i)};a.useEffect(()=>{C(c),g()},[c]),a.useEffect(()=>{const e=setInterval(async()=>await g(),2e4);return function(){clearInterval(e)}},[]);const W=e=>{const s=new URL(window.location),n="group";v(e),s.searchParams.has(n)?s.searchParams.set(n,e):s.searchParams.append(n,e),window.history.pushState({},"",s);const i=new Event("urlchange");window.dispatchEvent(i)},I=e=>{S(e)};return t.jsxs(H,{user:f.user,children:[t.jsx(L,{title:"Timetable"}),t.jsxs("div",{className:"bg-white",children:[t.jsxs("div",{className:"flex justify-between px-6 py-2",children:[t.jsx("h1",{className:"text-2xl font-semibold",children:"Розклад групи"}),t.jsxs("h2",{children:["Час: ",T]})]}),t.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-2 lg:gap-6 px-6 py-4 text-gray-900 w-full",children:[t.jsx("div",{className:"min-w-[190px] max-w-[260px] grid lg:gap-3",children:t.jsx(R,{suggestionsEndpoint:"/api/v1/search/group",onSearch:W,defaultValue:c,isFocused:!1})}),!N&&t.jsx("div",{className:"min-w-[190px] max-w-[260px] content-center grid lg:gap-3",children:t.jsxs("div",{className:"flex content-center items-center gap-4 justify-center",children:[t.jsx("span",{className:"font-semibold text-xl",children:"1"}),t.jsx(F,{initialValue:o,onChange:I}),t.jsx("span",{className:"font-semibold text-xl",children:"2"})]})})]}),t.jsx("div",{className:"grid px-6 text-gray-900 w-full gap-12 max-xl:hidden",children:t.jsx(_,{currentLesson:x,currentDay:m,currentWeek:r||d,selectedPGroup:o+1,timetable:u,weekDefault:r?!r:p,singleWeek:r})}),t.jsx("div",{className:"grid px-6 text-gray-900 w-full gap-12 xl:hidden",children:t.jsx(A,{currentLesson:x,currentDay:m,currentWeek:r||d,selectedPGroup:o+1,timetable:u,weekDefault:r?!r:p,singleWeek:r})})]})]})}export{K as default};
