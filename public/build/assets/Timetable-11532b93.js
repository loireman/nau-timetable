import{r as l,j as r,a as t,b as Q,h as S}from"./app-9c633b3e.js";import{A as U}from"./AuthenticatedLayout-f58b9f58.js";import{S as p}from"./Select-941f699f.js";import{I as X}from"./InputSwitch-89848145.js";import"./ApplicationLogo-8482edb2.js";import"./Dropdown-77418e2c.js";import"./transition-ad9216bd.js";function re({auth:y,department:G,stream:i,group:h,pgroup:T}){const[$,W]=l.useState([]),[V,j]=l.useState([]),[w,M]=l.useState(G),[E,L]=l.useState([]),[f,b]=l.useState(i),[P,A]=l.useState([]),[N,g]=l.useState(h),[D,o]=l.useState(T),[d,C]=l.useState(0),[v,H]=l.useState(0),[x,O]=l.useState(0),[z,F]=l.useState(0);async function I(){const e=await S.get("/api/v1/departments");j(e.data.data)}async function k(e){const n=await S.get(`/api/v1/streams/${e}`);L(n.data.data)}async function u(e,n=null){const a=await S.get(`/api/v1/groups/${e}`+(n!=null?`/${n}`:""));a.data.data.groups&&A(a.data.data.groups),a.data.data.timetables&&W(a.data.data.timetables)}const R=()=>{var e=new Date(new Date().toLocaleString("en",{timeZone:"Europe/Rome"})),n=e.getDay(),a=e.getHours()*60+e.getMinutes(),s=0;if(a>525&&a<1275)for(a=a-525,s++;a>0;)a=a-110,s++;e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var c=new Date(e.getFullYear(),0,4),m=1+Math.round(((e.getTime()-c.getTime())/864e5-3+(c.getDay()+6)%7)/7);m=(m%2==(n==0)?1:0)+1,C(m-1),H(m),O(n),F(s)};l.useEffect(()=>{I(),k(i),u(i),u(i,h),R()},[i,h]);const Y=e=>{M(e),k(e),b(0),g(0),o(0)},Z=e=>{b(e),u(e),g(0),o(0)},q=e=>{g(e),u(f,e),o(0)},B=e=>{o(e)},J=e=>{C(e)},K=e=>{var n=new Date().getTimezoneOffset(),a=540+(e-1)*110+n,s=Math.floor(a/60),c=a%60;return s+":"+(c==0?"00":c)};return r(U,{user:y.user,children:[t(Q,{title:"Timetable"}),r("div",{className:"bg-white",children:[r("div",{className:"flex flex-wrap gap-6 p-6 text-gray-900 w-full",children:[r("div",{className:"min-w-[190px] grid gap-3",children:[t("span",{className:"font-bold text-xl",children:"Факультет"}),t(p,{options:V,defaultValue:"Виберіть факультет",defaultSelectable:!1,value:w,onChange:Y})]}),r("div",{className:"min-w-[190px] grid gap-3",children:[t("span",{className:"font-bold text-xl",children:"Поток"}),w!=0?t(p,{options:E,defaultValue:"Виберіть поток",defaultSelectable:!1,value:f,onChange:Z}):null]}),r("div",{className:"min-w-[190px] grid gap-3",children:[t("span",{className:"font-bold text-xl",children:"Група"}),f!=0?t(p,{options:P,defaultValue:"Виберіть групу",defaultSelectable:!1,value:N,onChange:q}):null]}),r("div",{className:"min-w-[190px] grid gap-3",children:[t("span",{className:"font-bold text-xl",children:"Підгрупа"}),N!=0?t(p,{options:["Без підгруп","Перша","Друга"],defaultValue:"Без підгруп",defaultSelectable:!1,value:D,onChange:B}):null]})]}),r("div",{className:"grid px-6 text-gray-900 w-full gap-12 max-xl:hidden",children:[r("div",{className:"flex content-center items-center gap-4 justify-center",children:[t("span",{className:"font-semibold text-xl",children:"Week 1"}),t(X,{initialValue:d,onChange:J}),t("span",{className:"font-semibold text-xl",children:"Week 2"})]}),r("table",{className:"timetable",children:[t("thead",{children:t("tr",{children:["Пн","Вт","Ср","Чт","Пт","Сб"].map((e,n)=>t("th",{className:`${n+1==x&&d+1==v?"day-active":""}`,children:e},n))})}),t("tbody",{children:[1,2,3,4,5,6,7].map(e=>t("tr",{children:[1,2,3,4,5,6].map((n,a)=>r("td",{className:`${a+1==x&&d+1==v?"day-active":""}`,children:[t("div",{className:"time",children:K(e)}),$.map((s,c)=>t("div",{children:(s.pgroup==0||s.pgroup==D)&&s.week==d+1&&s.day==n&&s.lesson==e?r("div",{className:"card-default relative overflow-hidden lesson",children:[t("div",{className:`lesson-type type-${s.type} ${s.week==v&&s.day==x&&s.lesson==z?"active":""}`}),t("span",{className:"text-xl font-semibold",children:s.name})]}):null},c))]},n))},e))})]})]})]})]})}export{re as default};
