import{r as o,j as s,g as R}from"./app-c34707ae.js";import{I as U}from"./InputSwitch-b28ec4e3.js";import{M as B}from"./Modal-fd49b7f3.js";import{I as W}from"./iconify-b1806c0c.js";const V=({currentLesson:p=1,currentDay:c=1,currentWeek:j=1,selectedPGroup:N,timetable:e,weekDefault:v,isTeacher:k=!1})=>{var M,E,w,C,a,S;const[u,$]=o.useState(0),[h,b]=o.useState(!1),[i,f]=o.useState(null);o.useEffect(()=>{$(v)},[v]);const d=t=>{$(t)},T=t=>{const r=new Date().toLocaleString("en-US",{timeZone:"Europe/London"}),m=new Date(r);m.setHours(6),m.setMinutes(0),m.setSeconds(0);const n=new Date().getTimezoneOffset(),l=m.getHours()*60-n+(t-1)*110,x=l+95,O=D=>{const F=Math.floor(D/60),L=D%60;return F+":"+(L<10?"0"+L:L)};return`${O(l)} - ${O(x)}`},g=t=>{b(!0),f(t)},I=()=>{b(!1)};return s.jsxs("div",{children:[s.jsxs("div",{className:"flex content-center items-center gap-4 justify-center mb-4",children:[s.jsx("span",{className:"font-medium text-xl",children:"Week 1"}),s.jsx(U,{initialValue:u,onChange:d}),s.jsx("span",{className:"font-medium text-xl",children:"Week 2"})]}),s.jsxs("table",{className:"timetable",children:[s.jsx("thead",{children:s.jsx("tr",{children:["Пн","Вт","Ср","Чт","Пт","Сб"].map((t,r)=>s.jsx("th",{className:`${r+1===c&&u+1===j?"day-active":""}`,children:t},r))})}),s.jsx("tbody",{children:[1,2,3,4,5,6,7].map(t=>s.jsx("tr",{children:[1,2,3,4,5,6].map((r,m)=>s.jsxs("td",{className:`${m+1===c&&u+1===j?"day-active":""}`,children:[r===1?s.jsx("div",{className:"time",children:T(t)}):s.jsx("div",{className:"time inactive"}),e.map((n,l)=>s.jsx("div",{children:(k||n.pgroup===0||n.pgroup==N)&&n.week===u+1&&n.day===r&&n.lesson===t?s.jsxs("div",{className:"card-default relative overflow-hidden lesson",onClick:()=>g(l),children:[s.jsx("div",{className:`lesson-type type-${n.type} ${n.week===j&&n.day===c&&n.lesson===p?"active":""}`}),s.jsx("span",{className:"text-xl font-semibold",children:n.name})]}):null},l))]},r))},t))})]}),s.jsx(B,{show:h,onClose:I,children:e[i]&&s.jsxs("div",{className:"card-modal",children:[s.jsx("button",{className:"fixed right-4",onClick:I,children:s.jsx(W,{icon:"mdi:close"})}),s.jsx("div",{children:s.jsx("h5",{className:"form-text font-semibold",children:(M=e[i])==null?void 0:M.name})}),s.jsxs("div",{children:[s.jsx("span",{className:"form-label",children:"Тип"}),s.jsx("h5",{className:"form-text",children:["Лекція","Практична","Лабораторна"].map((t,r)=>{var m;return s.jsx("div",{children:r==((m=e[i])==null?void 0:m.type)?t:null},r)})})]}),k==!0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("span",{className:"form-label",children:"Група"}),s.jsx("h5",{className:"form-text",children:(E=e[i])==null?void 0:E.group})]}),((w=e[i])==null?void 0:w.type)==2?s.jsxs("div",{children:[s.jsx("span",{className:"form-label",children:"Підрупа"}),s.jsx("h5",{className:"form-text",children:(C=e[i])==null?void 0:C.pgroup})]}):null]}):s.jsxs("div",{children:[s.jsx("span",{className:"form-label",children:"Викладач"}),s.jsx("h5",{className:"form-text",children:((a=e[i])==null?void 0:a.teacher)??s.jsx("small",{children:"Не визначений/а"})})]}),s.jsxs("div",{children:[s.jsx("span",{className:"form-label",children:"Аудиторія"}),s.jsx("h5",{className:"form-text",children:((S=e[i])==null?void 0:S.auditory)??s.jsx("small",{children:"Не визначена"})})]})]})})]})},K=V,Z=({selectedDay:p,onSelectDay:c})=>{const j=["Пн","Вт","Ср","Чт","Пт","Сб"];return s.jsx("div",{className:"day-selector",children:j.map((N,e)=>s.jsx("span",{className:`font-semibold ${p===e+1?"day-active":""}`,onClick:()=>c(e+1),children:N},e))})},q=({selectedWeek:p,onSelectWeek:c})=>s.jsxs("div",{className:"week-selector",children:[s.jsx("span",{className:`font-semibold ${p===0?"week-active":""}`,onClick:()=>c(0),children:"Тиждень 1"}),s.jsx("span",{className:`font-semibold ${p===1?"week-active":""}`,onClick:()=>c(1),children:"Тиждень 2"})]}),Q=({currentLesson:p=1,currentDay:c=1,currentWeek:j=1,selectedPGroup:N,timetable:e,weekDefault:v,isTeacher:k=!1})=>{var C,a,S,t,r,m;const[u,$]=o.useState(v),[h,b]=o.useState(c),[i,f]=o.useState(!1),[d,T]=o.useState(null);o.useEffect(()=>{$(v),b(c)},[v,c]);const g=n=>{$(n)},I=n=>{const l=new Date().toLocaleString("en-US",{timeZone:"Europe/London"}),x=new Date(l);x.setHours(6),x.setMinutes(0),x.setSeconds(0);const O=new Date().getTimezoneOffset(),D=x.getHours()*60-O+(n-1)*110,F=D+95,L=H=>{const z=Math.floor(H/60),y=H%60;return z+":"+(y<10?"0"+y:y)};return`${L(D)} - ${L(F)}`},M=n=>{b(n)},E=n=>{f(!0),T(n)},w=()=>{f(!1)};return s.jsxs("div",{className:"timetable-container",children:[s.jsxs("table",{className:"timetable",children:[s.jsx("thead",{children:s.jsx("tr",{children:s.jsx("th",{className:`text-xl ${c===h&&u+1===j?"day-active":""}`,children:["Понеділок","Вівторок","Середа","Четвер","П'ятниця","Субота"][h-1]})})}),s.jsx("tbody",{children:[1,2,3,4,5,6,7].map(n=>s.jsx("tr",{children:s.jsxs("td",{className:`${h===c&&u+1===j?"day-active":""}`,children:[s.jsx("div",{className:"time",children:s.jsx("span",{children:I(n)})}),e.map((l,x)=>s.jsx("div",{children:(k||l.pgroup===0||l.pgroup==N)&&l.week===u+1&&l.day===h&&l.lesson===n?s.jsxs("div",{className:"card-default relative overflow-hidden lesson",onClick:()=>E(x),children:[s.jsx("div",{className:`lesson-type type-${l.type} ${l.week===j&&l.day===c&&l.lesson===p?"active":""}`}),s.jsx("span",{className:"text-xl font-semibold",children:l.name})]}):null},x))]})},n))})]}),s.jsx(B,{show:i,onClose:w,children:e[d]&&s.jsxs("div",{className:"card-modal",children:[s.jsx("button",{className:"fixed right-4",onClick:w,children:s.jsx(W,{icon:"mdi:close"})}),s.jsx("div",{children:s.jsx("h5",{className:"form-text font-semibold",children:(C=e[d])==null?void 0:C.name})}),s.jsxs("div",{children:[s.jsx("span",{className:"form-label",children:"Тип"}),s.jsx("h5",{className:"form-text",children:["Лекція","Практична","Лабораторна"].map((n,l)=>{var x;return s.jsx("div",{children:l==((x=e[d])==null?void 0:x.type)?n:null},l)})})]}),k==!0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("span",{className:"form-label",children:"Група"}),s.jsx("h5",{className:"form-text",children:(a=e[d])==null?void 0:a.group})]}),((S=e[d])==null?void 0:S.type)==2?s.jsxs("div",{children:[s.jsx("span",{className:"form-label",children:"Підрупа"}),s.jsx("h5",{className:"form-text",children:(t=e[d])==null?void 0:t.pgroup})]}):null]}):s.jsxs("div",{children:[s.jsx("span",{className:"form-label",children:"Викладач"}),s.jsx("h5",{className:"form-text",children:((r=e[d])==null?void 0:r.teacher)??s.jsx("small",{children:"Не визначений/а"})})]}),s.jsxs("div",{children:[s.jsx("span",{className:"form-label",children:"Аудиторія"}),s.jsx("h5",{className:"form-text",children:((m=e[d])==null?void 0:m.auditory)??s.jsx("small",{children:"Не визначена"})})]})]})}),s.jsxs("div",{className:"selectors-bottom",children:[s.jsx(q,{selectedWeek:u,onSelectWeek:g}),s.jsx("div",{className:"vertical-line"}),s.jsx(Z,{selectedDay:h,onSelectDay:M})]})]})},P=Q,X=o.forwardRef(function({type:c="search",className:j="",isFocused:N=!1,suggestionsEndpoint:e,onSearch:v,defaultValue:k="",...u},$){const h=$||o.useRef(),[b,i]=o.useState(k),[f,d]=o.useState([]),[T,g]=o.useState(!1);o.useEffect(()=>{R.get(`${e}`).then(a=>{d(a.data)}).catch(a=>{console.error("Error fetching suggestions:",a)})},[]),o.useEffect(()=>{N&&(h.current.focus(),g(!0))},[N]);const I=()=>{setTimeout(()=>{g(!1)},90)},M=()=>{g(!0)},E=()=>{h.current.focus(),g(!0)},w=a=>{const S=a.target.value;i(S),e&&R.get(`${e}/${S}`).then(t=>{d(t.data)}).catch(t=>{console.error("Error fetching suggestions:",t)})},C=a=>{a&&(i(a),v(a),h.current.blur())};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:`form-search ${j}`,onClick:E,children:[s.jsx("input",{...u,type:c,ref:h,value:b,onChange:w,onBlur:I,onFocus:M}),T&&f.length!==0&&s.jsx("ul",{className:"options",style:{maxHeight:f.length>10?"200px":"auto",overflowY:"auto"},children:Object.keys(f).map(a=>s.jsx("li",{className:"option",onClick:()=>C(f[a]),children:f[a]},a))})]})})});export{X as S,K as T,P as a};
